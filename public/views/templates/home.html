<!-- home page ================================================== -->  	
<div ng-include="'views/templates/head.html'"></div>

<div id="submit-block" class="row row-group">
	
	<div id="hook-box" class="col-sm-offset-1 col-sm-5">
    <span class="">Compare your water bill with your neighbors. Submit your bill to see fees and usage.</span>
	</div>
	
	<div class="panel panel-default col-sm-5">
		<div class="panel-body">

			<div ng-form name="formData" ng-init="step = 1" novalidate>

			  <div ng-show="step==1">
					<div ng-form='formData1'>
						<div class="form-title">
							<h3>About You</h3>
						</div>
						<div class="form-group" ng-class="{ 'has-error' : formData1.addr.$invalid && !formData1.addr.$pristine && !formData1.addr.$focused}">
						  <label for="InputAddr">Location</label>
						  <input 
						  	type="text"
						  	name="addr"
						  	class="form-control" 
						  	id="InputAddr"
						  	ng-model="formData.addr"
						  	placeholder="93406"
						  	required
								ng-focus
								ng-autocomplete="result"
								details="details"
								options="{country: 'us'}">
							<p ng-show="formData1.addr.$invalid && !formData1.addr.$pristine && !formData1.addr.$focused" class="help-block">Your Location is required.</p>
						</div>

						<div class="form-group" ng-class="{ 'has-error' : formData1.hsize.$invalid && !formData1.hsize.$pristine && !formData1.hsize.$focused }">
						  <label for="InputUse">Number of people in your household</label>
						  <input 
						  	type="number"
						  	name="hsize"
						  	class="form-control"
						  	id="InputHsize"
						  	ng-model="formData.hsize"
						  	placeholder="4"
						  	required
						  	ng-focus>
						  <p ng-show="formData1.hsize.$invalid && !formData1.hsize.$pristine && !formData1.hsize.$focused" class="help-block">Your Household size is required.</p>
						</div>
					</div>
			    <button type="button" class="btn btn-default" ng-disabled="formData1.$invalid" ng-click="step = 2">Next</button>
			  </div>

			  <div ng-show="step==2">
					<div ng-form='formData2'>
						<div class="form-title">
							<h3>Your Water Bill</h3>
						</div>
						<div class="form-group" ng-class="{ 'has-error' : formData2.util.$invalid && !formData2.util.$pristine && !formData2.util.$focused}">
						  <label for="InputUtil">Water Provider</label>
						  <input 
						  	type="text"
						  	name="util"
						  	class="form-control" 
						  	id="InputUtil"
						  	ng-model="formData.util"
						  	placeholder="SWA"
						  	required
								ng-focus>
							<p ng-show="formData2.util.$invalid && !formData2.util.$pristine && !formData2.util.$focused" class="help-block">Your Water Provider is required.</p>
						</div>
						
						<div class="form-group" ng-class="{ 'has-error' : formData2.bill.$invalid && !formData2.bill.$pristine && !formData2.bill.$focused }">
						  <label for="InputBill">Total Bill: $</label>
						  <input 
						  	type="number"
						  	name="bill"
						  	class="form-control"
						  	id="InputBill"
						  	ng-model="formData.bill"
						  	placeholder="45.55"
						  	required
						  	ng-focus>
						  <p ng-show="formData2.bill.$invalid && !formData2.bill.$pristine && !formData2.bill.$focused" class="help-block">Your Total Bill is required.</p>
						</div>

						<div class="form-group inline col-sm-6" ng-class="{ 'has-error' : formData2.sdate.$invalid && !formData2.sdate.$pristine && !formData2.sdate.$focused }">
						  <label for="InputSdate">Billing Start Date</label>
              <div class="input-group">
              	<input 
              		type="text"
              		name="sdate"
              		class="form-control"
              		id="InputSdate"
              		datepicker-popup="{{format}}"
              		ng-model="formData.sdate"
              		is-open="opened1" min="minDate"
              		max="'2015-06-22'"
              		datepicker-options="dateOptions"
              		date-disabled="disabled(date, mode)"
              		placeholder="DD-Month-YYYY"
              		ng-required="true"
              		close-text="Close"
              		ng-focus/>
              	<span class="input-group-btn">
              	  <button class="btn btn-default" ng-click="open1($event)"><i class="glyphicon glyphicon-calendar"></i></button>
              	</span>
              </div>
						  <p ng-show="formData2.sdate.$invalid && !formData2.sdate.$pristine && !formData2.sdate.$focused" class="help-block">Your Billing Start Date is required.</p>
						</div>

						<div class="form-group inline col-sm-6" ng-class="{ 'has-error' : formData2.edate.$invalid && !formData2.edate.$pristine && !formData2.edate.$focused }">
						  <label for="InputEdate">Billing End Date</label>
              <div class="input-group">
              	<input 
              		type="text"
              		name="edate"
              		class="form-control"
              		id="InputSdate"
              		datepicker-popup="{{format}}"
              		ng-model="formData.edate"
              		is-open="opened2" min="minDate"
              		max="'2015-01-01'"
              		datepicker-options="dateOptions"
              		date-disabled="disabled(date, mode)"
              		placeholder="DD-Month-YYYY"
              		ng-required="true"
              		close-text="Close"
              		ng-focus/>
              	<span class="input-group-btn">
              	  <button class="btn btn-default" ng-click="open2($event)"><i class="glyphicon glyphicon-calendar"></i></button>
              	</span>
              </div>
						  <p ng-show="formData2.edate.$invalid && !formData2.edate.$pristine && !formData2.edate.$focused" class="help-block">Your Billing End Date is required.</p>
						</div>

						<div class="form-group" ng-class="{ 'has-error' : formData2.used.$invalid && !formData2.used.$pristine && !formData2.used.$focused }">
						  <label for="InputUsed">Metered Water Consumption</label>
						  <input 
						  	type="number"
						  	name="used"
						  	class="form-control"
						  	id="InputUsed"
						  	ng-model="formData.used"
						  	placeholder="101"
						  	required
						  	ng-focus>
						  <p ng-show="formData2.used.$invalid && !formData2.used.$pristine && !formData2.used.$focused" class="help-block">Your Metered Water Consumption is required.</p>
						</div>

						<div class="form-group" ng-class="{ 'has-error' : formData2.units.$invalid && !formData2.units.$pristine && !formData2.units.$focused }">
						  <label for="InputUnits">Consumption Units</label>
						  <input 
						  	type="text"
						  	name="units"
						  	class="form-control"
						  	id="InputUnits"
						  	ng-model="formData.units"
						  	placeholder="gal/gal or ccf/1,000"
						  	required
						  	ng-focus>
						  <p ng-show="formData2.units.$invalid && !formData2.units.$pristine && !formData2.units.$focused" class="help-block">Your Unit type is required.</p>
						</div>
					</div>
			    <button type="button" class="btn btn-default" ng-click="step = 1">Back</button>
			    <a type="submit" class="btn btn-success" ng-disabled="formData.$invalid" ng-click="createBill()" ng-href="#/participate" role="button">Submit</a>
			  </div>

			  <!-- <div ng-show="step==3">
					<div ng-form='formData3'>
						<div class="form-group" ng-class="{ 'has-error' : formData3.lat.$invalid && !formData3.lat.$pristine && !formData3.lat.$focused}">
						  <label for="InputLat">Latitude</label>
						  <input 
						  	type="number"
						  	name="lat"
						  	class="form-control" 
						  	id="InputLat"
						  	ng-model="formData.lat"
						  	placeholder="37.166111"
						  	required
								ng-focus>
							<p ng-show="formData3.lat.$invalid && !formData3.lat.$pristine && !formData3.lat.$focused" class="help-block">Your Lat is required.</p>
						</div>
						
						<div class="form-group" ng-class="{ 'has-error' : formData3.lng.$invalid && !formData3.lng.$pristine && !formData3.lng.$focused }">
						  <label for="InputUse">Longitude</label>
						  <input 
						  	type="number"
						  	name="lng"
						  	class="form-control"
						  	id="InputLng"
						  	ng-model="formData.lng"
						  	placeholder="-119.449444"
						  	required
						  	ng-focus>
						  <p ng-show="formData3.lng.$invalid && !formData3.lng.$pristine && !formData3.lng.$focused" class="help-block">Your Lng is required.</p>
						</div>
						
						<div class="form-group" ng-class="{ 'has-error' : formData3.rate.$invalid && !formData3.rate.$pristine && !formData3.rate.$focused }">
						  <label for="InputRate">Rate TEST</label>
						  <input 
						  	type="number"
						  	name="rate"
						  	class="form-control"
						  	id="InputRate"
						  	ng-model="formData.rate"
						  	placeholder="9"
						  	required
						  	ng-focus>
						  <p ng-show="formData3.rate.$invalid && !formData3.rate.$pristine && !formData3.rate.$focused" class="help-block">Your Rate is required.</p>
						</div>

					</div>
					
					<div>{{details.geometry.location.d}}</div>
	      	<div>{{details.geometry.location.e}}</div>
					
					<button type="button" class="btn btn-default" ng-click="step = 2">Back</button>
					<button type="submit" class="btn btn-success" ng-disabled="formData.$invalid" ng-click="createBill()">Submit</button> 
			  </div> -->

			</div><!-- ng-form -->
		
		</div><!-- .panel-body -->
	</div><!-- .panel -->
</div><!-- .row-group -->



<!-- <div class="row row-group">
	
	<div class="panel panel-default col-sm-6 col-sm-offset-3">
		<div class="col-sm-6">
		    <h4>Validation status:</h4>
		    <p><strong>Step1 valid?</strong> {{formData1.$valid}}</p>
		    <p><strong>Step2 valid?</strong> {{formData2.$valid}}</p>
		    <p><strong>Step3 valid?</strong> {{formData3.$valid}}</p>
		    <p><strong>Whole form valid?</strong> {{formData.$valid}}</p>		
		</div>
		
		<div class="col-sm-6">
			<h4>click to delete bill</h4>
			<div class="checkbox" ng-repeat="entry in entries">
				<label>
					<input type="checkbox" ng-click="deleteBill(entry._id)"> Total Bill: ${{ entry.bill }}
				</label>
			</div>
		</div>
	</div>

</div>

<div class="row row-group">
	<div class="col-sm-6 col-sm-offset-3">
		<h2 class="bar-title">Crowdsourcing the Pricing of Water</h2>
		<div mapuser id="map" userdata="entries"></div>
		<div class="text-center">
			<h1>Bills Submitted (test) <span class="label label-info">{{ entries.length }}</span></h1>
		</div>
	</div>
</div>


<div id="bill-list" class="row row-group">

	<div class="panel panel-default col-sm-offset-1 col-sm-7" ng-controller="chartController">
		<div d3-bars data="entries" on-click="onClick(item)" bar-height="40" bar-padding="5"></div>
		<div ng-show="showDetailPanel">
	    <h3>Details</h3>
	    <h3>Item: {{ detailItem._id }}</h4>
	    <a ng-click="showDetailPanel=false">Hide</a>
	  </div>
	</div>
</div> -->